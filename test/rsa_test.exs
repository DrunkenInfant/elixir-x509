defmodule X509.RSATest do
  use ExUnit.Case

  test "parse rsa private key" do
    assert {:rsa_private_key,
            %{
              d:
                20_215_123_184_791_680_679_882_536_036_742_642_343_503_403_639_117_592_343_120_968_389_914_007_346_293_632_049_622_853_224_872_003_922_476_415_546_457_468_609_250_550_019_330_279_639_069_800_034_092_514_351_304_234_632_986_021_335_409_867_644_284_197_995_556_909_137_920_855_768_862_597_432_851_614_440_677_476_702_682_867_115_609_413_823_003_851_382_744_045_760_570_825_517_461_311_648_844_937_990_042_515_803_217_092_200_643_358_562_530_946_639_757_351_383_299_262_691_846_106_717_951_863_090_520_245_084_326_221_497_614_037_776_264_272_785_011_905_086_408_436_813_962_973_174_973_711_258_055_869_719_410_004_034_493_028_730_547_822_148_866_516_197_195_879_116_519_872_692_177_837_362_829_598_203_736_948_932_071_830_754_018_683_403_324_444_718_391_805_335_546_338_458_655_872_756_370_505_850_659_419_648_366_024_719_817,
              dp:
                69_191_622_330_584_077_225_121_045_928_104_711_673_534_676_850_094_753_554_616_360_165_812_427_508_798_767_987_042_819_241_803_571_626_874_563_978_144_907_761_827_111_684_276_221_826_474_720_527_505_624_728_003_613_791_126_595_771_149_018_680_493_972_160_671_211_869_665_237_728_321_635_813_186_963_651_074_727_962_051_872_966_240_258_595_436_262_912_833_804_288_431_752_125_804_182_966_818_151_255_390_823_425,
              dq:
                123_946_861_516_323_330_003_694_826_703_469_734_855_966_031_520_157_358_928_459_510_164_862_415_391_173_524_699_592_072_587_309_383_994_869_416_804_815_748_515_815_836_956_861_914_032_001_649_250_550_939_544_909_902_247_508_172_916_242_838_764_964_138_930_671_641_874_862_569_617_935_972_581_227_437_926_165_193_756_192_025_253_467_571_290_550_764_748_990_578_522_854_964_807_296_132_505_754_942_713_560_051_343,
              e: 65537,
              n:
                24_224_068_460_289_487_789_900_747_183_997_413_674_392_177_219_228_934_365_638_201_996_119_915_515_423_849_694_394_560_929_557_633_268_130_713_383_704_505_681_820_652_330_673_210_157_168_775_206_785_780_348_529_476_973_213_232_163_587_363_474_857_901_373_805_802_676_343_806_559_103_838_802_669_474_970_263_476_452_500_906_221_420_236_487_140_542_467_149_924_613_017_318_972_735_221_179_542_350_680_247_506_138_349_331_885_976_068_115_495_564_251_029_213_109_221_107_746_660_535_798_103_773_795_942_751_563_918_327_458_628_032_663_620_360_181_384_655_653_680_899_339_975_743_851_508_119_492_643_740_616_924_823_110_873_754_293_642_864_590_340_015_063_839_177_033_803_823_068_963_442_652_844_032_077_986_411_809_701_386_546_150_316_624_091_405_135_988_349_608_718_505_477_363_824_015_002_558_102_207_111_342_016_709_858_643,
              p:
                156_755_093_773_488_961_183_032_286_607_791_706_614_644_708_127_926_571_616_043_017_014_202_470_327_853_458_848_410_717_804_552_014_439_659_786_346_642_796_597_997_214_409_997_606_120_079_983_379_809_738_931_110_786_678_272_390_315_742_299_407_616_615_510_713_122_659_784_661_400_754_115_261_643_875_719_043_295_300_366_205_703_418_412_180_901_077_244_136_788_981_296_727_705_642_586_390_222_662_431_711_435_109,
              q:
                154_534_489_930_472_407_085_554_035_150_105_507_719_118_154_812_832_737_222_380_879_248_065_977_694_118_506_387_085_811_112_993_343_458_037_800_230_899_071_824_998_050_159_647_279_747_270_847_273_534_803_100_062_023_467_990_927_963_698_410_047_359_550_520_297_296_557_649_923_429_100_539_047_957_816_025_246_614_728_423_033_559_145_899_736_874_830_578_419_015_402_879_212_947_317_923_257_484_289_558_044_042_327,
              qi:
                5_173_541_701_133_140_427_434_957_988_374_711_773_001_029_442_307_278_323_992_950_648_351_783_499_951_852_076_064_393_540_629_745_009_223_438_428_415_958_675_432_190_244_546_746_643_959_106_836_635_025_901_916_570_546_037_838_149_964_020_911_568_699_601_760_224_989_657_704_918_059_703_203_874_516_487_034_189_603_371_267_313_759_877_557_050_654_196_399_212_946_560_495_989_823_049_215_265_676_577_455_227_462
            }} == X509.parse_pem(X509.CertificateHelper.rsa_private_key()) |> List.first()
  end

  test "parse public key" do
    assert {:public_key,
            {
              :rsa_pkcs1,
              %{
                e: 65537,
                n:
                  24_224_068_460_289_487_789_900_747_183_997_413_674_392_177_219_228_934_365_638_201_996_119_915_515_423_849_694_394_560_929_557_633_268_130_713_383_704_505_681_820_652_330_673_210_157_168_775_206_785_780_348_529_476_973_213_232_163_587_363_474_857_901_373_805_802_676_343_806_559_103_838_802_669_474_970_263_476_452_500_906_221_420_236_487_140_542_467_149_924_613_017_318_972_735_221_179_542_350_680_247_506_138_349_331_885_976_068_115_495_564_251_029_213_109_221_107_746_660_535_798_103_773_795_942_751_563_918_327_458_628_032_663_620_360_181_384_655_653_680_899_339_975_743_851_508_119_492_643_740_616_924_823_110_873_754_293_642_864_590_340_015_063_839_177_033_803_823_068_963_442_652_844_032_077_986_411_809_701_386_546_150_316_624_091_405_135_988_349_608_718_505_477_363_824_015_002_558_102_207_111_342_016_709_858_643
              }
            }} == X509.parse_pem(X509.CertificateHelper.public_key()) |> List.first()
  end
end
