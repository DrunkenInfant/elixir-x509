defmodule X509.RSATest do
  use ExUnit.Case

  test "parse rsa private key" do
    assert {:rsa_private_key, %{
        d: 20215123184791680679882536036742642343503403639117592343120968389914007346293632049622853224872003922476415546457468609250550019330279639069800034092514351304234632986021335409867644284197995556909137920855768862597432851614440677476702682867115609413823003851382744045760570825517461311648844937990042515803217092200643358562530946639757351383299262691846106717951863090520245084326221497614037776264272785011905086408436813962973174973711258055869719410004034493028730547822148866516197195879116519872692177837362829598203736948932071830754018683403324444718391805335546338458655872756370505850659419648366024719817,
        dp: 69191622330584077225121045928104711673534676850094753554616360165812427508798767987042819241803571626874563978144907761827111684276221826474720527505624728003613791126595771149018680493972160671211869665237728321635813186963651074727962051872966240258595436262912833804288431752125804182966818151255390823425,
        dq: 123946861516323330003694826703469734855966031520157358928459510164862415391173524699592072587309383994869416804815748515815836956861914032001649250550939544909902247508172916242838764964138930671641874862569617935972581227437926165193756192025253467571290550764748990578522854964807296132505754942713560051343,
        e: 65537,
        n: 24224068460289487789900747183997413674392177219228934365638201996119915515423849694394560929557633268130713383704505681820652330673210157168775206785780348529476973213232163587363474857901373805802676343806559103838802669474970263476452500906221420236487140542467149924613017318972735221179542350680247506138349331885976068115495564251029213109221107746660535798103773795942751563918327458628032663620360181384655653680899339975743851508119492643740616924823110873754293642864590340015063839177033803823068963442652844032077986411809701386546150316624091405135988349608718505477363824015002558102207111342016709858643,
        p: 156755093773488961183032286607791706614644708127926571616043017014202470327853458848410717804552014439659786346642796597997214409997606120079983379809738931110786678272390315742299407616615510713122659784661400754115261643875719043295300366205703418412180901077244136788981296727705642586390222662431711435109,
        q: 154534489930472407085554035150105507719118154812832737222380879248065977694118506387085811112993343458037800230899071824998050159647279747270847273534803100062023467990927963698410047359550520297296557649923429100539047957816025246614728423033559145899736874830578419015402879212947317923257484289558044042327,
        qi: 5173541701133140427434957988374711773001029442307278323992950648351783499951852076064393540629745009223438428415958675432190244546746643959106836635025901916570546037838149964020911568699601760224989657704918059703203874516487034189603371267313759877557050654196399212946560495989823049215265676577455227462
      }} == X509.parse_pem(X509.CertificateHelper.rsa_private_key()) |> List.first()
  end

  test "parse public key" do
    assert {:public_key, {
      {:rsa_pkcs1, :any},
      %{
        e: 65537,
        n: 24224068460289487789900747183997413674392177219228934365638201996119915515423849694394560929557633268130713383704505681820652330673210157168775206785780348529476973213232163587363474857901373805802676343806559103838802669474970263476452500906221420236487140542467149924613017318972735221179542350680247506138349331885976068115495564251029213109221107746660535798103773795942751563918327458628032663620360181384655653680899339975743851508119492643740616924823110873754293642864590340015063839177033803823068963442652844032077986411809701386546150316624091405135988349608718505477363824015002558102207111342016709858643,
      }
    }} == X509.parse_pem(X509.CertificateHelper.public_key()) |> List.first()
  end
end
